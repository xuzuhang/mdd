(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/mystate/index"],{"25f5":function(t,a,n){},"34ea":function(t,a,n){"use strict";(function(t){n("30b7"),n("921b");e(n("66fd"));var a=e(n("c27b"));function e(t){return t&&t.__esModule?t:{default:t}}t(a.default)}).call(this,n("6e42")["createPage"])},"63a4":function(t,a,n){"use strict";n.r(a);var e=n("ae9b"),i=n.n(e);for(var o in e)"default"!==o&&function(t){n.d(a,t,function(){return e[t]})}(o);a["default"]=i.a},8803:function(t,a,n){"use strict";var e=function(){var t=this,a=t.$createElement;t._self._c},i=[];n.d(a,"a",function(){return e}),n.d(a,"b",function(){return i})},ae9b:function(t,a,n){"use strict";(function(t,e){Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var i=c(n("5852")),o=c(n("ef4f"));function c(t){return t&&t.__esModule?t:{default:t}}var s={created:function(){this.getMyloctions()},data:function(){return{id:"",location:{latitude:"",longitude:""},dynamic:{arrs:[],Total:0,start:0,length:6,loadingText:"已全部加载完毕",times:0,loading:!1}}},mounted:function(){var t=this;this.$myhttp.get(this.websiteUrl+"/users","",function(a){t.id=a.data.data.id,t.getDynamic()})},onReachBottom:function(t){this.getDynamic()},methods:{toshops:function(a){t.navigateTo({url:"../shops/shop?id="+a})},removedynamic:function(a,n){var i=this;t.showModal({title:"提示",content:"确定要把删除本条动态么",success:function(o){o.confirm&&(console.log(e(n," at pages/mystate/index.vue:120")),i.$myhttp.delete(i.websiteUrl+"/news/"+n,"",function(n){console.log(e(n," at pages/mystate/index.vue:122")),i.dynamic.arrs.splice(a,1),i.dynamic.start-=1,i.dynamic.Total-=1,t.showToast({icon:"success",title:"删除成功"})}))}})},getMyloctions:function(){var a=this;t.getLocation({type:"gcj02",success:function(t){a.location={longitude:t.longitude,latitude:t.latitude}}})},getDynamic:function(){var t=this;this.dynamic.loading||(this.dynamic.loading=!0,0===this.dynamic.Total||this.dynamic.Total!=this.dynamic.arrs.length?(this.dynamic.loadingText="上拉加载更多",this.$myhttp.get(this.websiteUrl+"/news?start="+this.dynamic.start+"&length="+this.dynamic.length+"&userId="+this.id+"&sort=time","",function(a){a=a.data.data;if(t.dynamic.Total=a.totalCount,a.items.length){var n=a.items;if(n.forEach(function(a){a.loc=t.getDynamiclocation(a.location.lat,a.location.lon),a.time=t.times(a.createTime);var n=(0,o.default)(a.areaId);a.city=n.replace(/-/g,"")}),t.dynamic.start+=a.items.length,t.dynamic.arrs=t.dynamic.arrs.concat(n),0!==t.dynamic.Total&&t.dynamic.Total==t.dynamic.arrs.length)return void(t.dynamic.loadingText="已全部加载完毕")}else t.dynamic.loadingText="已全部加载完毕";t.dynamic.times++,t.dynamic.loading=!1},this)):this.dynamic.loadingText="已全部加载完毕")},getDynamiclocation:function(t,a){if(!this.location.latitude)return"";var n,e,i=t*Math.PI/180,o=a;e=this.location.longitude,n=this.location.latitude*Math.PI/180;var c=i-n,s=o*Math.PI/180-e*Math.PI/180,r=2*Math.asin(Math.sqrt(Math.pow(Math.sin(c/2),2)+Math.cos(i)*Math.cos(n)*Math.pow(Math.sin(s/2),2)));return r*=6378.137,r=parseInt(Math.round(1e4*r)/10),(r/1e3).toFixed(2)+"km"},times:function(t){var a="",n=new Date(t),e=n.getTime(),o=(new Date).getTime(),c=o-e,s=2592e6,r=864e5,l=36e5,u=6e4;if(c<r){if(c<l){for(var d=1;d<=60;d++)if(c<=d*u){a=d+"分钟前";break}}else for(d=2;d<=24;d++)if(c<d*l){a=d+"小时前";break}}else if(c<s){for(var f=2;f<=30;f++)if(c<f*r){a=f+"天前";break}}else a=(0,i.default)(n);return a}},onNavigationBarButtonTap:function(){t.navigateTo({url:"release"})}};a.default=s}).call(this,n("6e42")["default"],n("0de9")["default"])},c27b:function(t,a,n){"use strict";n.r(a);var e=n("8803"),i=n("63a4");for(var o in i)"default"!==o&&function(t){n.d(a,t,function(){return i[t]})}(o);n("daa4");var c=n("2877"),s=Object(c["a"])(i["default"],e["a"],e["b"],!1,null,null,null);a["default"]=s.exports},daa4:function(t,a,n){"use strict";var e=n("25f5"),i=n.n(e);i.a}},[["34ea","common/runtime","common/vendor"]]]);