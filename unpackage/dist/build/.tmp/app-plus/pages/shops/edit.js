(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/shops/edit"],{"0b44":function(t,e,a){"use strict";var s=a("3dc0"),i=a.n(s);i.a},2221:function(t,e,a){"use strict";(function(t){a("30b7"),a("921b");s(a("66fd"));var e=s(a("2987"));function s(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,a("6e42")["createPage"])},"232a":function(t,e,a){"use strict";a.r(e);var s=a("50ef"),i=a.n(s);for(var o in s)"default"!==o&&function(t){a.d(e,t,function(){return s[t]})}(o);e["default"]=i.a},2987:function(t,e,a){"use strict";a.r(e);var s=a("3ecb"),i=a("232a");for(var o in i)"default"!==o&&function(t){a.d(e,t,function(){return i[t]})}(o);a("0b44");var n=a("2877"),r=Object(n["a"])(i["default"],s["a"],s["b"],!1,null,null,null);e["default"]=r.exports},"3dc0":function(t,e,a){},"3ecb":function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement;t._self._c},i=[];a.d(e,"a",function(){return s}),a.d(e,"b",function(){return i})},"50ef":function(t,e,a){"use strict";(function(t,s){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=a("90c6"),o=c(a("4efa")),n=c(a("1101")),r=c(a("6372")),u=c(a("ef4f"));function c(t){return t&&t.__esModule?t:{default:t}}var l=function(){return Promise.all([a.e("common/vendor"),a.e("pages/components/pickcity")]).then(a.bind(null,"f703"))},d=function(){return a.e("pages/components/cpimg/cpimg").then(a.bind(null,"6b9a"))},h={components:{myCityPicker:l,cpimg:d},onShow:function(){var t=getCurrentPages(),e=t[t.length-1];e.data.objloc&&(this.msgs.address=e.data.objloc.address,e.setData({objloc:""}))},onLoad:function(){for(var e=this,a=0;a<i.areas.length;a++)this.areas[i.areas[a].id]=i.areas[a],this.cityname[i.areas[a].name]=i.areas[a];this.$myhttp.get(this.websiteUrl+"/my","",function(a){console.log(t(a," at pages/shops/edit.vue:141")),e.user=a.data.data.user;var s=a.data.data.shop;s.wechatNumber&&(e.iswechat=!0),e.msgs.areaId=s.areaId,e.msgs.mainBusiness=s.mainBusiness,e.msgs.position=s.position,e.msgs.address=s.address,e.msgs.wechatNumber=s.wechatNumber,e.msgs.profile=s.profile,e.msgs.longitude=s.longitude,e.msgs.latitude=s.latitude,e.imgArray=s.photos,e.address=(0,u.default)(s.areaId),e.firstMakeloc(s.areaId),e.shiming=a.data.data.hasIdCard,e.qiye=!!a.data.data.businessLicense,e.qiye&&(e.corporateName=s.corporateName)},this)},data:function(){return{iswechat:!1,corporateName:"",shiming:!1,qiye:!1,areas:{},cityname:{},cityPickerValueDefault:[0,0,0],themeColor:"#007AFF",count:4,dis:!1,imgArray:[],token:"",address:"",user:{},msgs:{areaId:"",mainBusiness:"",position:"",wechatNumber:"",address:"",profile:"",longitude:"",latitude:"",photos:[]}}},methods:{toshiming:function(){this.shiming||s.navigateTo({url:"../Authentication/realNamebg?title=个人认证&src=https://img.hm8848.com/APP/auimg.png&url=realName"})},toqiye:function(){this.qiye||(this.shiming?s.navigateTo({url:"../Authentication/realNamebg?title=企业认证&src=https://img.hm8848.com/APP/auimg2.png&url=enterprise"}):s.showToast({icon:"none",title:"请先进行实名认证"}))},firstMakeloc:function(t){var e=[],a=this.areas[t],s=this.areas[a.parentId];if(s.parentId)var i=this.areas[s.parentId];else{i=s;s=a}for(var u=o.default.length,c=0;c<u;c++)if(i.id==o.default[c].id){e[0]=c;break}for(var l=n.default[e[0]].length,d=0;d<l;d++)if(s.id==n.default[e[0]][d].id){e[1]=d;break}for(var h=r.default[e[0]][e[1]].length,f=0;f<h;f++)if(a.id==r.default[e[0]][e[1]][f].id){e[2]=f;break}this.cityPickerValueDefault=e},addPhoto:function(){if(!this.throttle){var t=this;plus.key.hideSoftKeybord(),this.throttle=!0,t.$refs.cpimg._changImg()}},cpimgOk:function(e){var a=this,i=0;s.showLoading({title:"上传中"});for(var o=0;o<e.length;o++)i++,this.upload(e[o],function(o){var n=JSON.parse(o.data).data;a.imgArray.push(n),console.log(t(o," at pages/shops/edit.vue:284")),i==e.length&&(s.hideLoading(),a.throttle=!1,a.count=4-a.imgArray.length)})},upload:function(e,a){s.uploadFile({url:"https://openapi.hm8848.com/my/shops/photos",filePath:e,name:"file",header:{authorization:this.$store.state.token},success:function(t){a(t)},fail:function(e){console.log(t(e," at pages/shops/edit.vue:307")),s.showToast({icon:"none",title:"上传失败"})}})},cpimgErr:function(e){console.log(t(e," at pages/shops/edit.vue:316")),this.throttle=!1},areapicshow:function(){this.$refs.myCityPicker.show()},onareasure:function(t){this.msgs.areaId=t.cityCode;var e=(0,u.default)(t.cityCode);this.address=e},showImg:function(e){s.previewImage({current:0,urls:[e],success:function(e){console.log(t(e," at pages/shops/edit.vue:333"))},fail:function(e){console.log(t(e," at pages/shops/edit.vue:336"))}})},remove:function(e){var a=this;s.showModal({title:"提示",content:"确定要删除么",success:function(s){s.confirm?a.imgArray.splice(e,1):s.cancel&&console.log(t("用户点击取消"," at pages/shops/edit.vue:348"))}})},sures:function(){if(this.msgs.areaId){for(var t=[],e=0;e<this.imgArray.length;e++)t.push(this.imgArray[e].key);this.msgs.photos=t,s.request({url:this.websiteUrl+"/my/shops",data:this.msgs,method:"PUT",header:{authorization:this.$store.state.token},success:function(t){0==t.data.code?(s.showToast({icon:"success",title:"修改成功"}),setTimeout(function(){s.navigateBack({delta:1})},1e3)):s.showToast({title:t.data.message,icon:"none"})}})}else s.showToast({icon:"none",title:"所在地为必填选项"})},chooseLocation:function(){this.$jurisdiction(function(){s.getLocation({type:"gcj02",success:function(t){s.navigateTo({url:"../components/map?lat="+t.latitude+"&lng="+t.longitude})}})})}}};e.default=h}).call(this,a("0de9")["default"],a("6e42")["default"])}},[["2221","common/runtime","common/vendor"]]]);