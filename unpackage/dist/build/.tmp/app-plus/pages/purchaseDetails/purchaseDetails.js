(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/purchaseDetails/purchaseDetails"],{"1ed1":function(t,e,a){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=a("90c6"),i=(s(a("4efa")),s(a("1101")),s(a("6372")),s(a("ef4f")));function s(t){return t&&t.__esModule?t:{default:t}}var o={onLoad:function(t){var e=this;this.userIds=t.userId,this.id=t.id;for(var a=0;a<n.areas.length;a++)this.areas[n.areas[a].id]=n.areas[a],this.cityname[n.areas[a].name]=n.areas[a];this.$store.state.token&&this.$myhttp.get(this.websiteUrl+"/my","",function(t){e.rank=t.data.data.shop.rank},this);try{this.getInfo()}catch(t){this.getInfo()}},data:function(){return{userIds:"",qiugou:0,rank:1,shareStr:"",shareDetailsDis:!1,stayCall:!0,location:"",areas:{},cityname:{},id:"",obj:{purchaseStr:"",avatarUrl:"",nickName:"",area:"",details:{name:"",unit:""},specificationsArr:[""]}}},onNavigationBarButtonTap:function(){this.shareDetailsDis=!0},methods:{nokaifang:function(){if(!this.$store.state.token)return t.showToast({icon:"none",title:"请登录"}),void setTimeout(function(){t.navigateTo({url:"../login/login1"})},1e3);t.showToast({icon:"none",title:"暂未开放,敬请期待"})},shareDetailsNone:function(){this.shareDetailsDis=!1},sharesweixin:function(e){var a=this;t.share({provider:"weixin",scene:e,type:0,title:this.obj.nickName+"想要求购 -- "+this.obj.details.name,imageUrl:"https://img.hm8848.com/APP/152x152.png",href:"https://m.miaodadang.com/wantBuyDrtails?id="+this.id,summary:this.shareStr,success:function(t){a.$store.state.token&&a.$myhttp.post(a.websiteUrl+"/my/share","",function(t){}),a.shareDetailsDis=!1},fail:function(t){}})},showImage:function(e,a){t.previewImage({current:a,urls:e})},showCall:function(){var e=this;if(!this.$store.state.token)return t.showToast({icon:"none",title:"请登录"}),void setTimeout(function(){t.navigateTo({url:"../login/login1"})},1e3);this.stayCall&&(this.stayCall=!1,this.$myhttp.post(this.websiteUrl+"/my/shops/"+this.obj.userId+"/contact?pay=true","",function(e){0==e.data.code?t.makePhoneCall({phoneNumber:e.data.data}):410==e.data.code?t.showModal({title:"提示",content:"积分不够，是否去赚积分？",cancelText:"否",confirmText:"是",success:function(e){e.confirm?t.navigateTo({url:"../my/integral"}):e.cancel}}):t.showToast({icon:"none",title:e.data.message})},this),setTimeout(function(){e.stayCall=!0},1e3))},toshop:function(){if(!this.$store.state.token)return t.showToast({icon:"none",title:"请登录"}),void setTimeout(function(){t.navigateTo({url:"../login/login1"})},1e3);t.navigateTo({url:"../shops/shop?id="+this.obj.userId})},toOffer:function(){if(!this.$store.state.token)return t.showToast({icon:"none",title:"请登录"}),void setTimeout(function(){t.navigateTo({url:"../login/login1"})},1e3);t.setStorage({key:"purOffer",data:JSON.stringify(this.obj),success:function(){t.navigateTo({url:"../wantBuy/offer"})}})},getInfo:function(){var t=this;this.$http.get(this.websiteUrl+"/purchases/search?start=0&length=0&userId="+this.userIds,"",function(e){t.qiugou=e.data.data.totalCount}),this.$http.get(this.websiteUrl+"/purchases/snapshots/"+this.id,"",function(e){var a=e.data.data;a.area=(0,i.default)(a.areaId),a.area=a.area.replace(/-/g,""),a.details=t.$store.state.categories[a.categoryId],a.specificationsArr=[];var n=JSON.parse(a.specifications),s=n.length;t.shareStr="";for(var o=0;o<s;o++){var r="",c="",u="";c=n[o].value instanceof Array?n[o].value[0]==n[o].value[1]?n[o].value[0]:n[o].value[0]+c+"-"+n[o].value[1]:n[o].value,n[o].unit&&(u=n[o].unit),r=n[o].name+": "+c+u,a.specificationsArr.push(r),t.shareStr+=r+";"}a.purchaseStr="";for(var l=0;l<a.acceptedAreas.length;l++){if(a.acceptedAreas[l]){(0,i.default)(a.acceptedAreas[l]),a.acceptedAreas[l];a.purchaseStr+=(0,i.default)(a.acceptedAreas[l])+";"}else a.purchaseStr+="全国;"}t.obj=a,t.getlocation()},this)},getlocation:function(){var e=this;t.getLocation({type:"gcj02",success:function(t){var a,n,i=e.obj.location.lat*Math.PI/180,s=e.obj.location.lon;n=t.longitude,a=t.latitude*Math.PI/180;var o=i-a,r=s*Math.PI/180-n*Math.PI/180,c=2*Math.asin(Math.sqrt(Math.pow(Math.sin(o/2),2)+Math.cos(i)*Math.cos(a)*Math.pow(Math.sin(r/2),2)));c*=6378.137,c=parseInt(Math.round(1e4*c)/10),e.location=(c/1e3).toFixed(2)+"公里"},fail:function(){e.location=""},complete:function(){}})}}};e.default=o}).call(this,a("6e42")["default"])},"3a839":function(t,e,a){"use strict";var n=a("908c"),i=a.n(n);i.a},"3b90":function(t,e,a){"use strict";(function(t){a("30b7"),a("921b");n(a("66fd"));var e=n(a("f2d9"));function n(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,a("6e42")["createPage"])},"4ec8":function(t,e,a){"use strict";a.r(e);var n=a("1ed1"),i=a.n(n);for(var s in n)"default"!==s&&function(t){a.d(e,t,function(){return n[t]})}(s);e["default"]=i.a},"908c":function(t,e,a){},e1fe:function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement;t._self._c},i=[];a.d(e,"a",function(){return n}),a.d(e,"b",function(){return i})},f2d9:function(t,e,a){"use strict";a.r(e);var n=a("e1fe"),i=a("4ec8");for(var s in i)"default"!==s&&function(t){a.d(e,t,function(){return i[t]})}(s);a("3a839");var o=a("2877"),r=Object(o["a"])(i["default"],n["a"],n["b"],!1,null,null,null);e["default"]=r.exports}},[["3b90","common/runtime","common/vendor"]]]);