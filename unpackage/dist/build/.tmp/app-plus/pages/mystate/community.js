(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/mystate/community"],{"3de2":function(t,a,n){},"44a2":function(t,a,n){"use strict";(function(t,i){Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var e=l(n("5852")),o=l(n("ef4f"));function l(t){return t&&t.__esModule?t:{default:t}}var c=function(){return n.e("pages/components/you-scroll").then(n.bind(null,"25b1"))},s={components:{youScroll:c},created:function(){this.getMyloctions()},data:function(){return{location:{latitude:"",longitude:""},tabs:2,dynamic:{arrs:[],Total:0,start:0,length:6,loadingText:"已全部加载完毕",times:0,loading:!1},followDynamic:{arrs:[],Total:0,start:0,length:6,loadingText:"已全部加载完毕",times:0,loading:!1},nearDynamic:{arrs:[],Total:0,start:0,length:6,loadingText:"已全部加载完毕",times:0,loading:!1}}},onPullDownRefresh:function(){this.dynamic={arrs:[],Total:0,start:0,length:6,loadingText:"已全部加载完毕",times:0,loading:!1},this.nearDynamic={arrs:[],Total:0,start:0,length:6,loadingText:"已全部加载完毕",times:0,loading:!1},this.getMyloctions(),setTimeout(function(){t.stopPullDownRefresh()},400)},methods:{onPullGuanZhu:function(t){this.followDynamic={arrs:[],Total:0,start:0,length:6,loadingText:"已全部加载完毕",times:0,loading:!1},this.getGuanZhu(),setTimeout(function(){t()},400)},onPullDynamic:function(t){this.dynamic={arrs:[],Total:0,start:0,length:6,loadingText:"已全部加载完毕",times:0,loading:!1},this.getDynamic(),setTimeout(function(){t()},400)},onPullNearLoc:function(t){this.nearDynamic={arrs:[],Total:0,start:0,length:6,loadingText:"已全部加载完毕",times:0,loading:!1},this.getNearLoc(),setTimeout(function(){t()},400)},showdynamicImg:function(a,n){t.previewImage({current:n+"",urls:a,loop:!0})},toshops:function(a){t.navigateTo({url:"../shops/shop?id="+a})},getMyloctions:function(){var a=this;t.getLocation({type:"gcj02",success:function(t){a.location={longitude:t.longitude,latitude:t.latitude},a.getNearLoc(),a.getDynamic(),a.getGuanZhu()}})},getGuanZhu:function(){var t=this;this.followDynamic.loading||(this.followDynamic.loading=!0,0===this.followDynamic.Total||this.followDynamic.Total!=this.followDynamic.arrs.length?(this.followDynamic.loadingText="上拉加载更多",this.$myhttp.get(this.websiteUrl+"/news?start="+this.followDynamic.start+"&length="+this.followDynamic.length+"&sort=time&followed=true","",function(a){console.log(i(a," at pages/mystate/community.vue:385"));a=a.data.data;if(t.followDynamic.Total=a.totalCount,a.items.length){var n=a.items;if(n.forEach(function(a){a.loc=t.getDynamiclocation(a.location.lat,a.location.lon),a.time=t.times(a.createTime);var n=(0,o.default)(a.areaId);a.city=n.replace(/-/g,"")}),t.followDynamic.start+=a.items.length,t.followDynamic.arrs=t.followDynamic.arrs.concat(n),0!==t.followDynamic.Total&&t.followDynamic.Total==t.followDynamic.arrs.length)return void(t.followDynamic.loadingText="已全部加载完毕")}else t.followDynamic.loadingText="已全部加载完毕";t.followDynamic.times++,t.followDynamic.loading=!1},this)):this.followDynamic.loadingText="已全部加载完毕")},getDynamic:function(){var t=this;this.dynamic.loading||(this.dynamic.loading=!0,0===this.dynamic.Total||this.dynamic.Total!=this.dynamic.arrs.length?(this.dynamic.loadingText="上拉加载更多",this.$myhttp.get(this.websiteUrl+"/news?start="+this.dynamic.start+"&length="+this.dynamic.length+"&sort=time","",function(a){console.log(i(a," at pages/mystate/community.vue:430"));a=a.data.data;if(t.dynamic.Total=a.totalCount,a.items.length){var n=a.items;if(n.forEach(function(a){a.loc=t.getDynamiclocation(a.location.lat,a.location.lon),a.time=t.times(a.createTime);var n=(0,o.default)(a.areaId);a.city=n.replace(/-/g,"")}),t.dynamic.start+=a.items.length,t.dynamic.arrs=t.dynamic.arrs.concat(n),0!==t.dynamic.Total&&t.dynamic.Total==t.dynamic.arrs.length)return void(t.dynamic.loadingText="已全部加载完毕")}else t.dynamic.loadingText="已全部加载完毕";t.dynamic.times++,t.dynamic.loading=!1},this)):this.dynamic.loadingText="已全部加载完毕")},getNearLoc:function(){var t=this;this.nearDynamic.loading||(this.nearDynamic.loading=!0,0===this.nearDynamic.Total||this.nearDynamic.Total!=this.nearDynamic.arrs.length?(this.nearDynamic.loadingText="上拉加载更多",this.$myhttp.get(this.websiteUrl+"/news?start="+this.nearDynamic.start+"&length="+this.nearDynamic.length+"&sort=distance&lat="+this.location.latitude+"&lon="+this.location.longitude,"",function(a){a=a.data.data;if(t.nearDynamic.Total=a.totalCount,a.items.length){var n=a.items;if(n.forEach(function(a){a.loc=t.getDynamiclocation(a.location.lat,a.location.lon),a.time=t.times(a.createTime);var n=(0,o.default)(a.areaId);a.city=n.replace(/-/g,"")}),t.nearDynamic.start+=a.items.length,t.nearDynamic.arrs=t.nearDynamic.arrs.concat(n),0!==t.nearDynamic.Total&&t.nearDynamic.Total==t.nearDynamic.arrs.length)return void(t.nearDynamic.loadingText="已全部加载完毕")}else t.nearDynamic.loadingText="已全部加载完毕";t.nearDynamic.times++,t.nearDynamic.loading=!1},this)):this.nearDynamic.loadingText="已全部加载完毕")},getDynamiclocation:function(t,a){if(!this.location.latitude)return"";var n,i,e=t*Math.PI/180,o=a;i=this.location.longitude,n=this.location.latitude*Math.PI/180;var l=e-n,c=o*Math.PI/180-i*Math.PI/180,s=2*Math.asin(Math.sqrt(Math.pow(Math.sin(l/2),2)+Math.cos(e)*Math.cos(n)*Math.pow(Math.sin(c/2),2)));return s*=6378.137,s=parseInt(Math.round(1e4*s)/10),(s/1e3).toFixed(2)+"km"},times:function(t){var a="",n=new Date(t),i=n.getTime(),o=(new Date).getTime(),l=o-i,c=2592e6,s=864e5,r=36e5,m=6e4;if(l<s){if(l<r){for(var u=1;u<=60;u++)if(l<=u*m){a=u+"分钟前";break}}else for(u=2;u<=24;u++)if(l<u*r){a=u+"小时前";break}}else if(l<c){for(var d=2;d<=30;d++)if(l<d*s){a=d+"天前";break}}else a=(0,e.default)(n);return a}}};a.default=s}).call(this,n("6e42")["default"],n("0de9")["default"])},"984b":function(t,a,n){"use strict";var i=n("3de2"),e=n.n(i);e.a},"9e3c":function(t,a,n){"use strict";n.r(a);var i=n("fbfc"),e=n("f313");for(var o in e)"default"!==o&&function(t){n.d(a,t,function(){return e[t]})}(o);n("984b");var l=n("2877"),c=Object(l["a"])(e["default"],i["a"],i["b"],!1,null,null,null);a["default"]=c.exports},f313:function(t,a,n){"use strict";n.r(a);var i=n("44a2"),e=n.n(i);for(var o in i)"default"!==o&&function(t){n.d(a,t,function(){return i[t]})}(o);a["default"]=e.a},f561:function(t,a,n){"use strict";(function(t){n("30b7"),n("921b");i(n("66fd"));var a=i(n("9e3c"));function i(t){return t&&t.__esModule?t:{default:t}}t(a.default)}).call(this,n("6e42")["createPage"])},fbfc:function(t,a,n){"use strict";var i=function(){var t=this,a=t.$createElement;t._self._c;t._isMounted||(t.e0=function(a){t.tabs=1},t.e1=function(a){t.tabs=2},t.e2=function(a){t.tabs=3})},e=[];n.d(a,"a",function(){return i}),n.d(a,"b",function(){return e})}},[["f561","common/runtime","common/vendor"]]]);